# -*- coding: utf-8 -*-
"""
Created on Mon Mar 23 14:54:18 2020

@author: Fajia Sun
"""

import math
import scipy.stats
import numpy as np
import pandas as pd
import csv

le=[['AAAAA', 0.6111231034908104], ['AAAAT', 0.31932886814153305], ['AAAAC', 0.39305945305282974], ['AAAAG', 0.6380372615920862], ['AAATA', 0.32120017420404795], ['AAATT', 0.40031570059836274], ['AAATC', 0.2748694821947305], ['AAATG', 0.28489659396052197], ['AAACA', 0.37369330060903555], ['AAACT', 0.32314992535721904], ['AAACC', 0.40073702367884584], ['AAACG', 0.3891775594706503], ['AAAGA', 0.5785342914859092], ['AAAGT', 0.39972223140769153], ['AAAGC', 0.4758850020946795], ['AAAGG', 0.5318444515435774], ['AATAA', 0.3523003370170076], ['AATAT', 0.2685416924792467], ['AATAC', 0.36432785952939506], ['AATAG', 0.40104662226451], ['AATTA', 0.4052255562359665], ['AATTT', 0.3858273330006416], ['AATTC', 0.2966995186798075], ['AATTG', 0.45858792780701446], ['AATCA', 0.3028434957832674], ['AATCT', 0.2539042007989992], ['AATCC', 0.398538961038961], ['AATCG', 0.32794711715020197], ['AATGA', 0.3325157673440785], ['AATGT', 0.30384647063668563], ['AATGC', 0.34709373221689294], ['AATGG', 0.29032664107244005], ['AACAA', 0.37427731786489443], ['AACAT', 0.3484985905135433], ['AACAC', 0.4821390336164442], ['AACAG', 0.3831743134489339], ['AACTA', 0.4031688364113432], ['AACTT', 0.5382792626406941], ['AACTC', 0.3109849766969563], ['AACTG', 0.37843041784702547], ['AACCA', 0.4115575993820618], ['AACCT', 0.3446661170651278], ['AACCC', 0.6400419637109273], ['AACCG', 0.39661927683868803], ['AACGA', 0.4077757288373727], ['AACGT', 0.30969356124346825], ['AACGC', 0.44432713308283905], ['AACGG', 0.494847841781706], ['AAGAA', 0.5552950666767501], ['AAGAT', 0.3584606514845777], ['AAGAC', 0.3683870446652128], ['AAGAG', 0.6067272795300632], ['AAGTA', 0.4967587617429889], ['AAGTT', 0.344133506879881], ['AAGTC', 0.37468024951756945], ['AAGTG', 0.3935539346498251], ['AAGCA', 0.46538043318541156], ['AAGCT', 0.40626153732555564], ['AAGCC', 0.4549941593590102], ['AAGCG', 0.40170420580159477], ['AAGGA', 0.5441341378757943], ['AAGGT', 0.4133393514339282], ['AAGGC', 0.3970415768168577], ['AAGGG', 0.6408867961546008], ['ATAAA', 0.3850007859163785], ['ATAAT', 0.29607837845132384], ['ATAAC', 0.36944299843831335], ['ATAAG', 0.43572309636270645], ['ATATA', 0.3974323386537127], ['ATATT', 0.3217194570135747], ['ATATC', 0.25038107230432766], ['ATATG', 0.3683020180932498], ['ATACA', 0.47880920162381596], ['ATACT', 0.40247278976513273], ['ATACC', 0.4273820772786475], ['ATACG', 0.4264117385504669], ['ATAGA', 0.4726986270537925], ['ATAGT', 0.37258637557283353], ['ATAGC', 0.49292465617262754], ['ATAGG', 0.45245444963107967], ['ATTAA', 0.3994174367215749], ['ATTAT', 0.3153204476093591], ['ATTAC', 0.4100377794102214], ['ATTAG', 0.514372433494019], ['ATTTA', 0.4362615453472759], ['ATTTT', 0.5232566774760502], ['ATTTC', 0.2968231126854107], ['ATTTG', 0.4204471924653102], ['ATTCA', 0.29335299579441804], ['ATTCT', 0.24703193801906248], ['ATTCC', 0.3953932541349937], ['ATTCG', 0.303559912292016], ['ATTGA', 0.37693316507064556], ['ATTGT', 0.38607897504541544], ['ATTGC', 0.45123118597120104], ['ATTGG', 0.40432066358672825], ['ATCAA', 0.3060845785721262], ['ATCAT', 0.2676347745378606], ['ATCAC', 0.3798305659098611], ['ATCAG', 0.3372199282474785], ['ATCTA', 0.3428783016539126], ['ATCTT', 0.20575672129316844], ['ATCTC', 0.2962893786577014], ['ATCTG', 0.25849062320113914], ['ATCCA', 0.408116172667595], ['ATCCT', 0.36142047674872996], ['ATCCC', 0.6412253374870197], ['ATCCG', 0.3862962556275393], ['ATCGA', 0.30699451945488526], ['ATCGT', 0.2517262830482115], ['ATCGC', 0.3708193041526375], ['ATCGG', 0.3874949358541526], ['ATGAA', 0.40173402968946975], ['ATGAT', 0.2847751695983671], ['ATGAC', 0.32860802361931224], ['ATGAG', 0.4772627319905005], ['ATGTA', 0.40404761904761904], ['ATGTT', 0.2622982981019177], ['ATGTC', 0.3143814145231245], ['ATGTG', 0.3911408540471638], ['ATGCA', 0.42540231951811563], ['ATGCT', 0.34866769434045364], ['ATGCC', 0.3837739288969918], ['ATGCG', 0.36481369282035747], ['ATGGA', 0.2600267091715849], ['ATGGT', 0.27908474576271186], ['ATGGC', 0.3482809121975033], ['ATGGG', 0.34719369160426744], ['ACAAA', 0.46032745591939545], ['ACAAT', 0.32811099780600106], ['ACAAC', 0.3969460588248293], ['ACAAG', 0.48468938529267896], ['ACATA', 0.4647240618101545], ['ACATT', 0.4218586729362591], ['ACATC', 0.31603040611482086], ['ACATG', 0.42395982783357244], ['ACACA', 0.5303446817508987], ['ACACT', 0.47751585108112504], ['ACACC', 0.4977413890457369], ['ACACG', 0.5864858240052292], ['ACAGA', 0.4446965399886557], ['ACAGT', 0.3866512166859791], ['ACAGC', 0.44777683594051015], ['ACAGG', 0.43077322430967907], ['ACTAA', 0.3902380708405916], ['ACTAT', 0.2974124962390934], ['ACTAC', 0.40894039735099336], ['ACTAG', 0.4781377928751851], ['ACTTA', 0.6844277546601711], ['ACTTT', 0.4990917460870431], ['ACTTC', 0.39371637397218556], ['ACTTG', 0.6941743444365698], ['ACTCA', 0.3607283916597777], ['ACTCT', 0.3005405819882682], ['ACTCC', 0.4878415035845766], ['ACTCG', 0.3735836646835481], ['ACTGA', 0.38861952861952864], ['ACTGT', 0.3831942789034565], ['ACTGC', 0.38704205703777683], ['ACTGG', 0.3391976066620526], ['ACCAA', 0.5086109986959846], ['ACCAT', 0.31959526682331024], ['ACCAC', 0.4276011283652398], ['ACCAG', 0.4263481228668942], ['ACCTA', 0.41938821971108076], ['ACCTT', 0.431238470052884], ['ACCTC', 0.3055686783984882], ['ACCTG', 0.329469595824736], ['ACCCA', 0.6234299096169851], ['ACCCT', 0.4805773242374697], ['ACCCC', 0.7940122567897927], ['ACCCG', 0.5714491121282561], ['ACCGA', 0.4117597004765146], ['ACCGT', 0.3699246972626437], ['ACCGC', 0.39888774459320286], ['ACCGG', 0.4037188780334069], ['ACGAA', 0.51891249968416], ['ACGAT', 0.3203610091637237], ['ACGAC', 0.37102845619538427], ['ACGAG', 0.5983905789990186], ['ACGTA', 0.45685848461484546], ['ACGTT', 0.27503316529583444], ['ACGTC', 0.31773309902832336], ['ACGTG', 0.3723681572087427], ['ACGCA', 0.49854395340650903], ['ACGCT', 0.4333735235671065], ['ACGCC', 0.43731547115822333], ['ACGCG', 0.4845619628754146], ['ACGGA', 0.4190504807692308], ['ACGGT', 0.3711467696205586], ['ACGGC', 0.48925424853467026], ['ACGGG', 0.5552316058441984], ['AGAAA', 0.5371763381434859], ['AGAAT', 0.3674724342663274], ['AGAAC', 0.3700911640953717], ['AGAAG', 0.5634119286669131], ['AGATA', 0.37658983161680565], ['AGATT', 0.38781342182890854], ['AGATC', 0.41339324539788375], ['AGATG', 0.2568995779960414], ['AGACA', 0.4690389792812829], ['AGACT', 0.3664581885568682], ['AGACC', 0.37479449857652675], ['AGACG', 0.4686946249261666], ['AGAGA', 0.6203905709572713], ['AGAGT', 0.5047727883839742], ['AGAGC', 0.5363442739337011], ['AGAGG', 0.6637745122624004], ['AGTAA', 0.4672989174197012], ['AGTAT', 0.3922925457102672], ['AGTAC', 0.43908510408023377], ['AGTAG', 0.48929332042594387], ['AGTTA', 0.3939696264272254], ['AGTTT', 0.431499358029388], ['AGTTC', 0.25100570266566463], ['AGTTG', 0.35940916780129556], ['AGTCA', 0.38783652914971917], ['AGTCT', 0.34366377927494385], ['AGTCC', 0.47262423714036617], ['AGTCG', 0.41440949468472404], ['AGTGA', 0.40258644925499015], ['AGTGT', 0.35201262825572216], ['AGTGC', 0.3757732209829039], ['AGTGG', 0.32457457457457456], ['AGCAA', 0.49081375957488904], ['AGCAT', 0.3571625724537676], ['AGCAC', 0.46295500583144067], ['AGCAG', 0.5337288755166887], ['AGCTA', 0.42211433046202035], ['AGCTT', 0.5822956200635963], ['AGCTC', 0.37609196277334755], ['AGCTG', 0.3480090579347107], ['AGCCA', 0.47064245237932684], ['AGCCT', 0.3989561126222157], ['AGCCC', 0.5926912329724066], ['AGCCG', 0.4393069427034895], ['AGCGA', 0.4644531127119444], ['AGCGT', 0.3297352250811069], ['AGCGC', 0.4222806079103867], ['AGCGG', 0.47036490807937736], ['AGGAA', 0.5583209218468292], ['AGGAT', 0.32216357561377174], ['AGGAC', 0.2726340963443799], ['AGGAG', 0.6804184297132111], ['AGGTA', 0.4781513718906022], ['AGGTT', 0.3756051983351737], ['AGGTC', 0.36748394629305314], ['AGGTG', 0.37059317761720717], ['AGGCA', 0.47215923406399596], ['AGGCT', 0.40196892420827895], ['AGGCC', 0.45909068148815785], ['AGGCG', 0.3701246064810451], ['AGGGA', 0.667253062288246], ['AGGGT', 0.5423312883435583], ['AGGGC', 0.5052631578947369], ['AGGGG', 0.7582859055908939], ['TAAAA', 0.5675495776716857], ['TAAAT', 0.29911590165919827], ['TAAAC', 0.3481583672754347], ['TAAAG', 0.5024008816352235], ['TAATA', 0.366108348599843], ['TAATT', 0.3979874691475223], ['TAATC', 0.2844473594159918], ['TAATG', 0.32764163749374864], ['TAACA', 0.4265713508298909], ['TAACT', 0.39942388834793896], ['TAACC', 0.4298633963872251], ['TAACG', 0.3933327406880612], ['TAAGA', 0.5136908696062695], ['TAAGT', 0.42017262906465447], ['TAAGC', 0.4343809764370512], ['TAAGG', 0.49816246356608795], ['TATAA', 0.3435427031509121], ['TATAT', 0.3384575747165922], ['TATAC', 0.46489251040221913], ['TATAG', 0.4247511223892251], ['TATTA', 0.4402207911683533], ['TATTT', 0.43535277644969606], ['TATTC', 0.2717758127216028], ['TATTG', 0.4054757015742642], ['TATCA', 0.30088871025366204], ['TATCT', 0.23818748973895912], ['TATCC', 0.3737090534833375], ['TATCG', 0.3034679504323794], ['TATGA', 0.3962719592329355], ['TATGT', 0.3136635638297872], ['TATGC', 0.3982440438136641], ['TATGG', 0.36345450109782873], ['TACAA', 0.455802736489812], ['TACAT', 0.4089175011921793], ['TACAC', 0.6314361579311937], ['TACAG', 0.47083572384777206], ['TACTA', 0.38514601057714415], ['TACTT', 0.5373776419976308], ['TACTC', 0.3581935599605346], ['TACTG', 0.36236667583509063], ['TACCA', 0.4401547959089653], ['TACCT', 0.3734178968067134], ['TACCC', 0.5636229322217239], ['TACCG', 0.3855229457950204], ['TACGA', 0.48761097124685304], ['TACGT', 0.38974358974358975], ['TACGC', 0.41738693467336685], ['TACGG', 0.45915932850388236], ['TAGAA', 0.5270957861976979], ['TAGAT', 0.3844224885902001], ['TAGAC', 0.5197587035427637], ['TAGAG', 0.6017385042691081], ['TAGTA', 0.4577783525151946], ['TAGTT', 0.38763312323407956], ['TAGTC', 0.3765807962529274], ['TAGTG', 0.41644626948775054], ['TAGCA', 0.5561951997165885], ['TAGCT', 0.5136437908496732], ['TAGCC', 0.5181874786590878], ['TAGCG', 0.4875695030712352], ['TAGGA', 0.48781346238451384], ['TAGGT', 0.4315426601551278], ['TAGGC', 0.45389167727919694], ['TAGGG', 0.600363521416153], ['TTAAA', 0.4555204280155642], ['TTAAT', 0.36435750770896597], ['TTAAC', 0.4112889347788677], ['TTAAG', 0.4649922587304318], ['TTATA', 0.43425939682068043], ['TTATT', 0.41005240891583], ['TTATC', 0.2615749804228661], ['TTATG', 0.38922841864018337], ['TTACA', 0.5057365482544941], ['TTACT', 0.41056445461479785], ['TTACC', 0.4333757596400337], ['TTACG', 0.45079847908745246], ['TTAGA', 0.4583829418768265], ['TTAGT', 0.45937140666922194], ['TTAGC', 0.5315198841599007], ['TTAGG', 0.5061841502519469], ['TTTAA', 0.42207409306499166], ['TTTAT', 0.3630913348946136], ['TTTAC', 0.44706433094340553], ['TTTAG', 0.48312948123154786], ['TTTTA', 0.5111909929462832], ['TTTTT', 0.803184076339132], ['TTTTC', 0.3941934243414728], ['TTTTG', 0.45868648768582204], ['TTTCA', 0.33922310072189754], ['TTTCT', 0.26646968702123003], ['TTTCC', 0.4399467978317607], ['TTTCG', 0.3429555997349238], ['TTTGA', 0.3369484015559391], ['TTTGT', 0.3704975821394676], ['TTTGC', 0.3630182978009065], ['TTTGG', 0.36512509083359285], ['TTCAA', 0.35403861209668014], ['TTCAT', 0.27133699250010473], ['TTCAC', 0.38975640224859465], ['TTCAG', 0.3691187050359712], ['TTCTA', 0.44163789712887297], ['TTCTT', 0.25851300143734485], ['TTCTC', 0.25117380153876506], ['TTCTG', 0.28752282045910277], ['TTCCA', 0.4388843145327295], ['TTCCT', 0.3800030321406913], ['TTCCC', 0.5300092336103417], ['TTCCG', 0.4200066577896138], ['TTCGA', 0.34148041987837474], ['TTCGT', 0.2870967741935484], ['TTCGC', 0.36579316513854726], ['TTCGG', 0.4014670296430732], ['TTGAA', 0.4705749768972434], ['TTGAT', 0.3104048844445314], ['TTGAC', 0.33423180592991913], ['TTGAG', 0.5597595663607577], ['TTGTA', 0.5436001759401803], ['TTGTT', 0.3025830258302583], ['TTGTC', 0.300073773515308], ['TTGTG', 0.4253765403925148], ['TTGCA', 0.46633223448473554], ['TTGCT', 0.38079444357733727], ['TTGCC', 0.4203314030158821], ['TTGCG', 0.3787077826725404], ['TTGGA', 0.3940836940836941], ['TTGGT', 0.37241657112756793], ['TTGGC', 0.3977427338576963], ['TTGGG', 0.491858842294145], ['TCAAA', 0.3851862195535518], ['TCAAT', 0.2562481825555947], ['TCAAC', 0.36249840744043826], ['TCAAG', 0.42940393781685277], ['TCATA', 0.47522965879265094], ['TCATT', 0.30947830241953], ['TCATC', 0.2323541121601638], ['TCATG', 0.34430282946724444], ['TCACA', 0.54756517461879], ['TCACT', 0.3888912837313562], ['TCACC', 0.409373060211049], ['TCACG', 0.45905678473393524], ['TCAGA', 0.4142241223144089], ['TCAGT', 0.3515219701231327], ['TCAGC', 0.3853226869509784], ['TCAGG', 0.38250452079566005], ['TCTAA', 0.41065531914893616], ['TCTAT', 0.32248110831234256], ['TCTAC', 0.3879097517487313], ['TCTAG', 0.5089020047802546], ['TCTTA', 0.3718451167894654], ['TCTTT', 0.27757588433684544], ['TCTTC', 0.24343146074386574], ['TCTTG', 0.3053176813555793], ['TCTCA', 0.32723926380368096], ['TCTCT', 0.2840754008870693], ['TCTCC', 0.3832993564376224], ['TCTCG', 0.32771448500348754], ['TCTGA', 0.3377087744060221], ['TCTGT', 0.31736040609137056], ['TCTGC', 0.29126194267515926], ['TCTGG', 0.30021759403170656], ['TCCAA', 0.6195030981170667], ['TCCAT', 0.30219325194347235], ['TCCAC', 0.43139079736128977], ['TCCAG', 0.48625180897250364], ['TCCTA', 0.48625260159929895], ['TCCTT', 0.4338230920230801], ['TCCTC', 0.33759360958562157], ['TCCTG', 0.4001434848892476], ['TCCCA', 0.5535997638289236], ['TCCCT', 0.5653003870830903], ['TCCCC', 0.7474068606503244], ['TCCCG', 0.6376110124333926], ['TCCGA', 0.47386223862238624], ['TCCGT', 0.3565677297126618], ['TCCGC', 0.4393392922481836], ['TCCGG', 0.46026435357290374], ['TCGAA', 0.5216836225812886], ['TCGAT', 0.24825770130076502], ['TCGAC', 0.26331825755772437], ['TCGAG', 0.5689606872723877], ['TCGTA', 0.43637898290778643], ['TCGTT', 0.24687196110210696], ['TCGTC', 0.2552521578633082], ['TCGTG', 0.3034913578354348], ['TCGCA', 0.49950846148444633], ['TCGCT', 0.39031839921331407], ['TCGCC', 0.4067897182102818], ['TCGCG', 0.4023453141386214], ['TCGGA', 0.5155206286836935], ['TCGGT', 0.37713918579522226], ['TCGGC', 0.42543072339323057], ['TCGGG', 0.5489415965314971], ['TGAAA', 0.47650479008462826], ['TGAAT', 0.32525378081624196], ['TGAAC', 0.3426169609321103], ['TGAAG', 0.4499803244283153], ['TGATA', 0.3172302737520129], ['TGATT', 0.275961675961676], ['TGATC', 0.2914038342609771], ['TGATG', 0.24841447946141088], ['TGACA', 0.367431133888533], ['TGACT', 0.2845608292416803], ['TGACC', 0.3118031163810377], ['TGACG', 0.3189000054671696], ['TGAGA', 0.5763875911044665], ['TGAGT', 0.4640112905755057], ['TGAGC', 0.42047884527264395], ['TGAGG', 0.5685887146561304], ['TGTAA', 0.46891442070224415], ['TGTAT', 0.37037037037037035], ['TGTAC', 0.44864833971537976], ['TGTAG', 0.5671156800189058], ['TGTTA', 0.3482486834199272], ['TGTTT', 0.34654462769478744], ['TGTTC', 0.23775115919629058], ['TGTTG', 0.2689232325147751], ['TGTCA', 0.34701114488348533], ['TGTCT', 0.3200876798561151], ['TGTCC', 0.43758889265154083], ['TGTCG', 0.3466999367400014], ['TGTGA', 0.4141670798215171], ['TGTGT', 0.44845908607863977], ['TGTGC', 0.3918964499536217], ['TGTGG', 0.4046920821114369], ['TGCAA', 0.43285129321515575], ['TGCAT', 0.34031290987446133], ['TGCAC', 0.5148574752763234], ['TGCAG', 0.41102577453788075], ['TGCTA', 0.4163214974547064], ['TGCTT', 0.5059813912272929], ['TGCTC', 0.33299564069503285], ['TGCTG', 0.29943129215712205], ['TGCCA', 0.4008519749314183], ['TGCCT', 0.372507869884575], ['TGCCC', 0.5204034374517573], ['TGCCG', 0.3472812879708384], ['TGCGA', 0.3651518081608973], ['TGCGT', 0.3154040173823199], ['TGCGC', 0.38662055002530793], ['TGCGG', 0.38387077258152336], ['TGGAA', 0.3502342986211779], ['TGGAT', 0.19908644583928906], ['TGGAC', 0.18920837770678026], ['TGGAG', 0.43018849107409995], ['TGGTA', 0.3786254836831832], ['TGGTT', 0.27204021247014365], ['TGGTC', 0.29166012250667506], ['TGGTG', 0.29111540318686624], ['TGGCA', 0.3993937663961723], ['TGGCT', 0.37585245135183065], ['TGGCC', 0.4619292801854946], ['TGGCG', 0.3017822854610802], ['TGGGA', 0.4271727061673564], ['TGGGT', 0.33352566049195265], ['TGGGC', 0.3323056171114751], ['TGGGG', 0.601700008585902], ['CAAAA', 0.5914948688503673], ['CAAAT', 0.3034994994062726], ['CAAAC', 0.3483172708127031], ['CAAAG', 0.5358666808194459], ['CAATA', 0.35662419961713643], ['CAATT', 0.36333811204234673], ['CAATC', 0.27191444910677925], ['CAATG', 0.3145307150700859], ['CAACA', 0.4173229475979401], ['CAACT', 0.4020189246936729], ['CAACC', 0.5026529054766145], ['CAACG', 0.42695191331321025], ['CAAGA', 0.5185793050391075], ['CAAGT', 0.4606344760397004], ['CAAGC', 0.44584032704842913], ['CAAGG', 0.5678359648496106], ['CATAA', 0.45084128407948026], ['CATAT', 0.2992061514364031], ['CATAC', 0.4835803754082475], ['CATAG', 0.529779225286313], ['CATTA', 0.4093572202655107], ['CATTT', 0.3784715383100256], ['CATTC', 0.2755175057500639], ['CATTG', 0.3937515497148525], ['CATCA', 0.27513378297077357], ['CATCT', 0.22425082988495293], ['CATCC', 0.3887469845324251], ['CATCG', 0.2760079817721232], ['CATGA', 0.42222063820182004], ['CATGT', 0.3509078551315662], ['CATGC', 0.35910855985142665], ['CATGG', 0.3532839085577128], ['CACAA', 0.5180554851143683], ['CACAT', 0.48234962670798703], ['CACAC', 0.6070034102703504], ['CACAG', 0.5054199594377229], ['CACTA', 0.37860989298130016], ['CACTT', 0.5958777491750316], ['CACTC', 0.41101856258924324], ['CACTG', 0.37683063658911065], ['CACCA', 0.457083636983125], ['CACCT', 0.36037759240564615], ['CACCC', 0.621873682731488], ['CACCG', 0.4060403689506469], ['CACGA', 0.5232902744157636], ['CACGT', 0.45275242861348247], ['CACGC', 0.5098832646654895], ['CACGG', 0.48798680705315234], ['CAGAA', 0.48800886473366223], ['CAGAT', 0.34692733746538307], ['CAGAC', 0.3768568931908315], ['CAGAG', 0.550360853358712], ['CAGTA', 0.4236866954922718], ['CAGTT', 0.3446004993757803], ['CAGTC', 0.3716792786990823], ['CAGTG', 0.35170947566191196], ['CAGCA', 0.461243179040504], ['CAGCT', 0.3905997536354765], ['CAGCC', 0.44326566477573753], ['CAGCG', 0.40523536204320065], ['CAGGA', 0.43719489297784453], ['CAGGT', 0.39292849791124296], ['CAGGC', 0.3991414490870836], ['CAGGG', 0.5534410394986489], ['CTAAA', 0.4047697997704374], ['CTAAT', 0.32908088355248133], ['CTAAC', 0.4191135800687781], ['CTAAG', 0.4554811958972867], ['CTATA', 0.38782025047065566], ['CTATT', 0.37443556790552274], ['CTATC', 0.25568079621080403], ['CTATG', 0.3578627808136005], ['CTACA', 0.5045526810232692], ['CTACT', 0.383634431455898], ['CTACC', 0.43138590146996664], ['CTACG', 0.43426180856008867], ['CTAGA', 0.500186846038864], ['CTAGT', 0.4419487307117969], ['CTAGC', 0.5413846312107807], ['CTAGG', 0.4708194250026919], ['CTTAA', 0.6554121434880474], ['CTTAT', 0.438153274950563], ['CTTAC', 0.545801771729362], ['CTTAG', 0.6711263714578893], ['CTTTA', 0.46380334383124433], ['CTTTT', 0.6520517452150273], ['CTTTC', 0.3593128646117201], ['CTTTG', 0.3878105683430743], ['CTTCA', 0.35956719179234176], ['CTTCT', 0.32782188395337136], ['CTTCC', 0.4455449273179182], ['CTTCG', 0.3550685470001474], ['CTTGA', 0.616540913610575], ['CTTGT', 0.4176402903168702], ['CTTGC', 0.4534887599226202], ['CTTGG', 0.5798501770101903], ['CTCAA', 0.3341348513102365], ['CTCAT', 0.2837676826758519], ['CTCAC', 0.39904939506958975], ['CTCAG', 0.372751275396044], ['CTCTA', 0.3645597834739691], ['CTCTT', 0.23349690030492115], ['CTCTC', 0.35403008098727345], ['CTCTG', 0.27665097604873323], ['CTCCA', 0.4121916795483567], ['CTCCT', 0.36608898440715165], ['CTCCC', 0.6542594916849702], ['CTCCG', 0.422049175956051], ['CTCGA', 0.3203277268461705], ['CTCGT', 0.2620393218180371], ['CTCGC', 0.366722819748607], ['CTCGG', 0.42976995940460083], ['CTGAA', 0.38911579444172156], ['CTGAT', 0.2818829071572599], ['CTGAC', 0.32068645464360807], ['CTGAG', 0.4616449311023622], ['CTGTA', 0.4211968434896975], ['CTGTT', 0.28125145382647126], ['CTGTC', 0.31559952445652173], ['CTGTG', 0.41085829493087556], ['CTGCA', 0.409097748131802], ['CTGCT', 0.33698836241779034], ['CTGCC', 0.3910609561044962], ['CTGCG', 0.3468306605613848], ['CTGGA', 0.26017478858500437], ['CTGGT', 0.2767502583909046], ['CTGGC', 0.3378092978385002], ['CTGGG', 0.38373806625232265], ['CCAAA', 0.5522307202039516], ['CCAAT', 0.3889763487859537], ['CCAAC', 0.46619217081850534], ['CCAAG', 0.5998059589384076], ['CCATA', 0.4385988530195741], ['CCATT', 0.34666377267712123], ['CCATC', 0.27055748529765794], ['CCATG', 0.35206064386124836], ['CCACA', 0.5249077289305292], ['CCACT', 0.4041777337595102], ['CCACC', 0.4658875918608991], ['CCACG', 0.50916822721598], ['CCAGA', 0.4927829955511616], ['CCAGT', 0.37360653518075554], ['CCAGC', 0.40075132427660265], ['CCAGG', 0.47805432620082017], ['CCTAA', 0.4469401311965457], ['CCTAT', 0.3495873400469448], ['CCTAC', 0.4537929277921637], ['CCTAG', 0.5125117220275406], ['CCTTA', 0.5680631899856806], ['CCTTT', 0.48513042842876974], ['CCTTC', 0.36593079121814753], ['CCTTG', 0.5083392174527038], ['CCTCA', 0.3337500289371947], ['CCTCT', 0.2782441211981832], ['CCTCC', 0.5046219609938551], ['CCTCG', 0.3203191021870669], ['CCTGA', 0.3926126976634411], ['CCTGT', 0.3371162225149458], ['CCTGC', 0.3645504127161926], ['CCTGG', 0.3626327934970167], ['CCCAA', 0.5457968388200947], ['CCCAT', 0.44658979658435766], ['CCCAC', 0.6105393973749619], ['CCCAG', 0.5505535864362188], ['CCCTA', 0.6216487539860636], ['CCCTT', 0.5531351192228436], ['CCCTC', 0.3706199460916442], ['CCCTG', 0.4493297257409913], ['CCCCA', 0.5957018707992636], ['CCCCT', 0.6232186197025328], ['CCCCC', 0.9773827896333351], ['CCCCG', 0.6996631450007655], ['CCCGA', 0.598499802605606], ['CCCGT', 0.42535099861578013], ['CCCGC', 0.5571860086864824], ['CCCGG', 0.5742959143197144], ['CCGAA', 0.6077068626737501], ['CCGAT', 0.32990072146512917], ['CCGAC', 0.39182321062533343], ['CCGAG', 0.6003254226525915], ['CCGTA', 0.4637423605392051], ['CCGTT', 0.3275226112879592], ['CCGTC', 0.3477958603254859], ['CCGTG', 0.3734252105519594], ['CCGCA', 0.5293985300734964], ['CCGCT', 0.43658679135008766], ['CCGCC', 0.41138746442167967], ['CCGCG', 0.43219109781524795], ['CCGGA', 0.4356075310559006], ['CCGGT', 0.4178770254719622], ['CCGGC', 0.39303396160861637], ['CCGGG', 0.5701131522286866], ['CGAAA', 0.6079094384004704], ['CGAAT', 0.4415640028987417], ['CGAAC', 0.4540008437631838], ['CGAAG', 0.5892695700969542], ['CGATA', 0.32198390444630565], ['CGATT', 0.2901928600738613], ['CGATC', 0.3340785381026439], ['CGATG', 0.26475002642426804], ['CGACA', 0.38885905485789823], ['CGACT', 0.3079862216690306], ['CGACC', 0.3515955357349169], ['CGACG', 0.33737272908764226], ['CGAGA', 0.6067242226433636], ['CGAGT', 0.5870841487279843], ['CGAGC', 0.5331223318121596], ['CGAGG', 0.6234536082474227], ['CGTAA', 0.40449692747713306], ['CGTAT', 0.3820123203285421], ['CGTAC', 0.43215135467035076], ['CGTAG', 0.4622610949141561], ['CGTTA', 0.2843383763051353], ['CGTTT', 0.31418419897001876], ['CGTTC', 0.22914900554287576], ['CGTTG', 0.2481361498180527], ['CGTCA', 0.34024924914557947], ['CGTCT', 0.2623586861997458], ['CGTCC', 0.38515450780503346], ['CGTCG', 0.2983789128568083], ['CGTGA', 0.3195303823576075], ['CGTGT', 0.3235874957853668], ['CGTGC', 0.3323729952943436], ['CGTGG', 0.3265948241957052], ['CGCAA', 0.4964923076923077], ['CGCAT', 0.36982099845777955], ['CGCAC', 0.5592622151281369], ['CGCAG', 0.4754870989224911], ['CGCTA', 0.43860520718510815], ['CGCTT', 0.5254080376237074], ['CGCTC', 0.33591220126892024], ['CGCTG', 0.34653555311007683], ['CGCCA', 0.39637036973536444], ['CGCCT', 0.38132459827641957], ['CGCCC', 0.5489347205859392], ['CGCCG', 0.37937826260622837], ['CGCGA', 0.42557153003052], ['CGCGT', 0.3168432329484585], ['CGCGC', 0.4703903768724836], ['CGCGG', 0.48327739006544157], ['CGGAA', 0.4693780524700696], ['CGGAT', 0.30212708910537134], ['CGGAC', 0.24447774809409006], ['CGGAG', 0.6250086355785838], ['CGGTA', 0.4297807683959193], ['CGGTT', 0.3508994023611152], ['CGGTC', 0.3417033301141038], ['CGGTG', 0.3543627868437407], ['CGGCA', 0.4417068761831561], ['CGGCT', 0.41392805647622793], ['CGGCC', 0.8210416167077238], ['CGGCG', 0.36407334356052307], ['CGGGA', 0.6054987550987975], ['CGGGT', 0.48212529849697994], ['CGGGC', 0.4407636423482943], ['CGGGG', 0.7833445823165983], ['GAAAA', 0.48009357043900885], ['GAAAT', 0.39075382803298], ['GAAAC', 0.4329078346410587], ['GAAAG', 0.5925500673452715], ['GAATA', 0.3387937005028757], ['GAATT', 0.4809315866084425], ['GAATC', 0.33966268289958673], ['GAATG', 0.36518827760095895], ['GAACA', 0.37437819420783647], ['GAACT', 0.33793103448275863], ['GAACC', 0.41554970808321684], ['GAACG', 0.46182615424297135], ['GAAGA', 0.4646723807375663], ['GAAGT', 0.4984502676810369], ['GAAGC', 0.45995189302827705], ['GAAGG', 0.45009693679720825], ['GATAA', 0.31586367186755826], ['GATAT', 0.27401921537229784], ['GATAC', 0.3686352389634067], ['GATAG', 0.3991771983307189], ['GATTA', 0.31201908538019557], ['GATTT', 0.40364692593190254], ['GATTC', 0.2711724616920606], ['GATTG', 0.33872773211373014], ['GATCA', 0.32146191810057356], ['GATCT', 0.2981991322044311], ['GATCC', 0.4928887347151158], ['GATCG', 0.35572479333463514], ['GATGA', 0.2622723589371775], ['GATGT', 0.2329229650407771], ['GATGC', 0.29370088613944156], ['GATGG', 0.2450312077544798], ['GACAA', 0.33517683820479494], ['GACAT', 0.36059547318851587], ['GACAC', 0.46506198415047184], ['GACAG', 0.4229296984408552], ['GACTA', 0.39841579476266475], ['GACTT', 0.342918121847109], ['GACTC', 0.26656504549135424], ['GACTG', 0.3094622001538569], ['GACCA', 0.3371017471736896], ['GACCT', 0.28595218270488876], ['GACCC', 0.45876453157054936], ['GACCG', 0.3605087784581036], ['GACGA', 0.3562406126117253], ['GACGT', 0.28501194947080916], ['GACGC', 0.3831691710403336], ['GACGG', 0.37527008073992646], ['GAGAA', 0.6308984047019311], ['GAGAT', 0.3834416632093302], ['GAGAC', 0.42838641596316196], ['GAGAG', 0.7929936305732485], ['GAGTA', 0.6529426249692194], ['GAGTT', 0.4455650929899857], ['GAGTC', 0.4769373837569746], ['GAGTG', 0.47740716806680916], ['GAGCA', 0.4497846434191999], ['GAGCT', 0.47008287851222963], ['GAGCC', 0.5260788618112096], ['GAGCG', 0.521565846740672], ['GAGGA', 0.5839202995113904], ['GAGGT', 0.5248839907192575], ['GAGGC', 0.538068055452591], ['GAGGG', 0.7413853851032345], ['GTAAA', 0.46863222046991526], ['GTAAT', 0.35505746760482665], ['GTAAC', 0.3843472142263161], ['GTAAG', 0.5218354211364108], ['GTATA', 0.3729404309252218], ['GTATT', 0.43114332476034606], ['GTATC', 0.27479511043200444], ['GTATG', 0.38045084996304507], ['GTACA', 0.47665494083786375], ['GTACT', 0.43962073834980836], ['GTACC', 0.43688967945692814], ['GTACG', 0.4322910125999414], ['GTAGA', 0.5388252085098791], ['GTAGT', 0.3951702839495582], ['GTAGC', 0.485851755526658], ['GTAGG', 0.45663698049194235], ['GTTAA', 0.30838097555041966], ['GTTAT', 0.3000665075701264], ['GTTAC', 0.35859213250517596], ['GTTAG', 0.3906396633669361], ['GTTTA', 0.32816613044749926], ['GTTTT', 0.5346865309131915], ['GTTTC', 0.3016115988909427], ['GTTTG', 0.289942458374143], ['GTTCA', 0.270745410765606], ['GTTCT', 0.22857142857142856], ['GTTCC', 0.34346570790434167], ['GTTCG', 0.2576808266360505], ['GTTGA', 0.2583896273697973], ['GTTGT', 0.28495459790297495], ['GTTGC', 0.33067032829858944], ['GTTGG', 0.2729728070713891], ['GTCAA', 0.3666743822695446], ['GTCAT', 0.29919683677251946], ['GTCAC', 0.43267967936234775], ['GTCAG', 0.3831384515676055], ['GTCTA', 0.3933321076178219], ['GTCTT', 0.2727512790889586], ['GTCTC', 0.34265003591719456], ['GTCTG', 0.3013485477178423], ['GTCCA', 0.4603424104677344], ['GTCCT', 0.38767302656191543], ['GTCCC', 0.5386402215670508], ['GTCCG', 0.4351259246945391], ['GTCGA', 0.3467515923566879], ['GTCGT', 0.2854196661348691], ['GTCGC', 0.3883743842364532], ['GTCGG', 0.409287084398977], ['GTGAA', 0.39165009940357853], ['GTGAT', 0.26226909514412344], ['GTGAC', 0.26355189283251795], ['GTGAG', 0.44501113134992915], ['GTGTA', 0.43866454249497816], ['GTGTT', 0.2764460386989963], ['GTGTC', 0.3116302186878728], ['GTGTG', 0.40534682080924855], ['GTGCA', 0.3880314455318466], ['GTGCT', 0.3531650415475038], ['GTGCC', 0.36859038308060654], ['GTGCG', 0.33405357407133346], ['GTGGA', 0.2584414247477867], ['GTGGT', 0.28604054561381553], ['GTGGC', 0.3396419130016823], ['GTGGG', 0.36079259223720195], ['GCAAA', 0.5032409215150332], ['GCAAT', 0.37484070921762663], ['GCAAC', 0.4676436239141216], ['GCAAG', 0.542046730283469], ['GCATA', 0.45287413901064494], ['GCATT', 0.3526910747427029], ['GCATC', 0.26550569678042585], ['GCATG', 0.3472558467504995], ['GCACA', 0.5700052200358594], ['GCACT', 0.45209395538003594], ['GCACC', 0.4623147316415899], ['GCACG', 0.558371693195053], ['GCAGA', 0.5016789791806582], ['GCAGT', 0.44527940286463585], ['GCAGC', 0.4593835941204362], ['GCAGG', 0.5237508644536653], ['GCTAA', 0.4406945506947286], ['GCTAT', 0.3371868978805395], ['GCTAC', 0.4411690981099915], ['GCTAG', 0.5422414519708931], ['GCTTA', 0.6908969465648855], ['GCTTT', 0.513516812934905], ['GCTTC', 0.4199382969426532], ['GCTTG', 0.6280245524588063], ['GCTCA', 0.3514661130900427], ['GCTCT', 0.31477016411293457], ['GCTCC', 0.48471088813387103], ['GCTCG', 0.3688969258589512], ['GCTGA', 0.3457724851143842], ['GCTGT', 0.32614541579988837], ['GCTGC', 0.34020154967253946], ['GCTGG', 0.3135952175206471], ['GCCAA', 0.5380177169943274], ['GCCAT', 0.34932134596080827], ['GCCAC', 0.4896624742579902], ['GCCAG', 0.41935521039775087], ['GCCTA', 0.4898785425101215], ['GCCTT', 0.46679365733113676], ['GCCTC', 0.34968261775935167], ['GCCTG', 0.36677517179979413], ['GCCCA', 0.5665437533503355], ['GCCCT', 0.4751831284167765], ['GCCCC', 0.7393038653896774], ['GCCCG', 0.5168574602714583], ['GCCGA', 0.48372241086587436], ['GCCGT', 0.42579883726013024], ['GCCGC', 0.48435656268258315], ['GCCGG', 0.47379482902418685], ['GCGAA', 0.5340575517987616], ['GCGAT', 0.28347085440511044], ['GCGAC', 0.3101873254803336], ['GCGAG', 0.5578869161991136], ['GCGTA', 0.37324295552803666], ['GCGTT', 0.24990331213935427], ['GCGTC', 0.2666552950923534], ['GCGTG', 0.28147193101115997], ['GCGCA', 0.4403943199155029], ['GCGCT', 0.38429491571878854], ['GCGCC', 0.4063056858307916], ['GCGCG', 0.4327349032408487], ['GCGGA', 0.3936612648788183], ['GCGGT', 0.35439316383941794], ['GCGGC', 0.4387170812762244], ['GCGGG', 0.5460827015109964], ['GGAAA', 0.5040786058583612], ['GGAAT', 0.3433022145028224], ['GGAAC', 0.3336959208899876], ['GGAAG', 0.43208209559816363], ['GGATA', 0.26513014747360786], ['GGATT', 0.38403372897667387], ['GGATC', 0.28554964539007094], ['GGATG', 0.18037961185753892], ['GGACA', 0.3078290856188372], ['GGACT', 0.223680148193887], ['GGACC', 0.27365692063949304], ['GGACG', 0.24446680080482897], ['GGAGA', 0.49803137682476223], ['GGAGT', 0.6187762661158203], ['GGAGC', 0.5390740077232374], ['GGAGG', 0.4752371916508539], ['GGTAA', 0.4680523108788324], ['GGTAT', 0.3661181609368528], ['GGTAC', 0.45308480580272426], ['GGTAG', 0.4295226770851028], ['GGTTA', 0.3494498166055352], ['GGTTT', 0.40434188360191986], ['GGTTC', 0.270643870498363], ['GGTTG', 0.30526724564004803], ['GGTCA', 0.3644593088071349], ['GGTCT', 0.33119118659628183], ['GGTCC', 0.5135222847252272], ['GGTCG', 0.33058462839623637], ['GGTGA', 0.2987523942641197], ['GGTGT', 0.33594034194252453], ['GGTGC', 0.342686442254045], ['GGTGG', 0.3265945330296128], ['GGCAA', 0.4852306589017891], ['GGCAT', 0.3101694915254237], ['GGCAC', 0.4804557374725353], ['GGCAG', 0.48485969660974043], ['GGCTA', 0.44983120780195046], ['GGCTT', 0.5576064355591914], ['GGCTC', 0.3683117023285934], ['GGCTG', 0.31902690634743447], ['GGCCA', 0.5419491525423729], ['GGCCT', 0.4187534847640057], ['GGCCC', 0.6161192542457335], ['GGCCG', 0.8271256318301189], ['GGCGA', 0.3608593602768593], ['GGCGT', 0.2689968542467669], ['GGCGC', 0.372395761281576], ['GGCGG', 0.3708701634030042], ['GGGAA', 0.6432943331806636], ['GGGAT', 0.3781411359724613], ['GGGAC', 0.32287935703677817], ['GGGAG', 0.6512040384746572], ['GGGTA', 0.5336078782452999], ['GGGTT', 0.37904567453115545], ['GGGTC', 0.3899163179916318], ['GGGTG', 0.4419912757327619], ['GGGCA', 0.4559660461078422], ['GGGCT', 0.4242405739581743], ['GGGCC', 0.5163931641354942], ['GGGCG', 0.3600837586703311], ['GGGGA', 0.7595826550244191], ['GGGGT', 0.5928532487485751], ['GGGGC', 0.5313143193178477], ['GGGGG', 1.024814553161427]]

#(1)error rate screening
def errorsta(seq,le):
    errortot=0
    lb=list(seq)
    for k in range(4,len(lb)):
        five=lb[k-4:k+1]
        compare=''.join(five)
        for m in range(len(le)):
            if compare == le[m][0]:
                error=le[m][1]
                errortot += error
    return errortot/(len(lb)-4)

#(2)error-prone seq screening
lesort=sorted(le,key=(lambda x:x[1]))
num=len(le)
lecut=lesort[960:] #May be set to other values

def errorproneseq(seq,lecut):
    flag=True
    lb=list(seq)
    for k in range(4,len(lb)):
        five=lb[k-4:k+1]
        compare=''.join(five)
        for m in range(len(lecut)):
            if compare == lecut[m][0]:
                flag=False
                break
    return flag

#(3)signal-to-noise ratio screening
#login k-mer model
f=csv.reader(open('kmer.csv'))
ls=[]
for line in f:
    ls.append([line[0],eval(line[1]),eval(line[2])])

mean1=ls[0][1]
std1=ls[0][2]
mean2=88
std2=ls[79][2]

#definite integral of gaussian distribution
def inte(mean1,std1,mean2,std2):
    x = np.linspace(0,100,10000)
    fx1 = 1 / (std1 * pow(2 * math.pi, 0.5)) * np.exp(-((x - mean1) ** 2) / (2 * std1 ** 2))
    fx2 = 1 / (std2 * pow(2 * math.pi, 0.5)) * np.exp(-((x - mean2) ** 2) / (2 * std2 ** 2))
    pox=0
    for i in range(len(fx1)):
        if fx1[i]>0.01 and fx1[i]-fx2[i] < 0.000000000001:
            pox=x[i]
            break
    if pox==0:
        return 10
    else:
        if mean1<=mean2:
            left=scipy.stats.norm(mean2,std2).cdf(pox)
            right=1-scipy.stats.norm(mean1,std1).cdf(pox)
        if mean1>mean2:
            left=scipy.stats.norm(mean1,std1).cdf(pox)
            right=1-scipy.stats.norm(mean2,std2).cdf(pox)
        area=left+right
        logis=-math.log(area)
        return logis

def xinzaobinew(seq):
    lb=list(seq)
    bizhi=0
    for k in range(5,len(lb)-1):
        five=lb[k-5:k+1]
        for i in range(len(five)):
            if five[i] == 'A':
                five[i]=0
            if five[i] == 'C':
                five[i]=1
            if five[i] == 'G':
                five[i]=2
            if five[i] == 'T':
                five[i]=3
        row=pow(4,0)*five[-1]+pow(4,1)*five[-2]+pow(4,2)*five[-3]+pow(4,3)*five[-4]+pow(4,4)*five[-5]+pow(4,5)*five[-6]
        mean1=ls[row][1]
        std1=ls[row][2]
        five2=lb[k-4:k+2]
        for i in range(len(five2)):
            if five2[i] == 'A':
                five2[i]=0
            if five2[i] == 'C':
                five2[i]=1
            if five2[i] == 'G':
                five2[i]=2
            if five2[i] == 'T':
                five2[i]=3
        row2=pow(4,0)*five2[-1]+pow(4,1)*five2[-2]+pow(4,2)*five2[-3]+pow(4,3)*five2[-4]+pow(4,4)*five2[-5]+pow(4,5)*five2[-6]
        mean2=ls[row2][1]
        std2=ls[row2][2]
        logis2=inte(mean1,std1,mean2,std2)
        bizhi += logis2
    return bizhi/(len(lb)-6)

#(4)GC ratio screening
def gccount(seq):
    a=seq.count('G')
    b=seq.count('C')
    if 0.4<(a+b)/len(seq)<0.6:
        return True
    else:
        return False

#(5)Bio-related screening
def GoldenGate(seq):
    return "GGTCTC" in seq or "GAGACC" in seq or "GAAGAC" in seq or "GTCTTC" in seq or "GCTCTTC" in seq or "GAAGAGC" in seq
#other sequences can also be screened, such as ORF

def screening5(seq):
    flag=True
    #thresholds below can be adjusted
    if errorsta(seq,le) > 0.4067737035279746:
        flag=False
    if errorproneseq(seq,lecut) == False:
        flag=False
    if xinzaobinew(seq) < 7.31960235852395:
        flag=False
    if gccount(seq) == False:
        flag=False
    if GoldenGate(seq) == True:
        flag=False
    print("Pass? {}".format(flag))
    return flag